<!DOCTYPE html>
<html ng-app="app">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <meta charset="utf-8" />
    <link href="http://cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" />
    <link href="http://cdn.bootcss.com/bootstrap-table/1.10.1/bootstrap-table.min.css" rel="stylesheet">
    <style>
        [ng\:cloak],
        [ng-cloak],
        [data-ng-cloak],
        [x-ng-cloak],
        .ng-cloak,
        .x-ng-cloak,
        .ng-hide {
            display: none !important;
        }
        .bs-radio {
            text-align: center; width: 10px;
        }
    </style>
</head>

<body ng-controller="ctrl" ng-cloak>
    <bt-table columns="columns" rows="rows" pager="pager" page-changed="pageChanged()" row-click="row_click(row, index)" cell-callback="edit(args, row, index)"
        config="config" refresh="refresh()">
        <div class="bs-bars pull-left">
            <div class="form-inline">
                <div class="btn-toolbar form-inline">
                    <a class="btn btn-sm btn-success" ng-click="new()">new</a>
                    <a class="btn btn-sm btn-danger" ng-click="remove()">remove</a>
                </div>
            </div>
        </div>
        <div class="columns columns-right btn-group pull-right">
            <button class="btn btn-default" type="button" name="refresh" ng-click="pageChanged()" title="刷新">
                    <i class="glyphicon glyphicon-refresh icon-refresh"></i>
                </button>
            <bt-show-columns columns="columns"></bt-show-columns>
        </div>
        <div class="pull-right search">
            <input class="form-control" type="text" ng-model="searchText" ng-change="text_filter(this.searchText)" placeholder="Search">
        </div>
    </bt-table>

    <script src="http://cdn.bootcss.com/angular.js/1.3.14/angular.js"></script>
    <script src="http://cdn.bootcss.com/angular.js/1.3.14/angular-animate.min.js"></script>
    <script src="http://cdn.bootcss.com/angular-ui-bootstrap/1.2.1/ui-bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/angular-ui-bootstrap/1.2.1/ui-bootstrap-tpls.min.js"></script>

    <script src="./dist/bt-table.js"></script>

    <script>
        var app = angular.module('app', ['ngAnimate', 'ui.bootstrap', 'bt-table'])

        app.controller('ctrl', function ($scope, $filter, $window, $timeout) {
            $scope.config = {
                //checkbox: true,
            }

            $scope.columns = [
                {
                    title: "radio",
                    th_class: 'bs-radio',
                    td_class: 'bs-radio',
                    formatter: '<input type="radio" name="radio_item" ng-click="$event.stopPropagation();callback(\'radio\')" ng-model="item.$radio" ng-value="true">',
                    sortable: false
                },
                {
                    title: 'id',
                    field: 'id',
                    sortable: true,
                },
                {
                    title: 'name',
                    field: 'name',
                    //sortable: true,
                },
                {
                    title: 'edit',
                    formatter: '<div><a class="btn btn-xs" ng-click=callback("edit")>edit</a></div>',
                },
            ]

            $scope.items = [
                { id: 1, name: 'name1' },
                { id: 2, name: 'name2' },
                { id: 3, name: 'name3' },
                { id: 4, name: 'name3' },
                { id: 5, name: 'name3' },
                { id: 6, name: 'name3' },
                { id: 7, name: 'name3' },
                { id: 8, name: 'name3' },
            ]

            $scope.rows = $scope.items

            $scope.radioItem = $scope.items[1]

            $scope.pager = {
                page_no: 1,
                page_size: 10,
                sort_name: 'id',
                is_desc: true,
                total_result: 100,
            }

            $scope.row_click = function (item, index) {
                $scope.radio_click(item)
            }

            $scope.pageChanged = function () {
                console.log('pageChanged')
            }

            $scope.edit = function (args, item, index) {
                console.log(args[0], item, index)
                if(args[0] === 'radio') {
                    $scope.radio_click(item)
                }
            }

            $scope.refresh = function () {
                console.log('refresh')
            }

            $scope.text_filter = function (searchText) {
                $scope.rows = $filter('filter')($scope.items, searchText)
            }

            $scope.radio_click = function (item) {
                $scope.items.forEach(t => t.$radio = false)
                item.$radio = true
            }
        })
    </script>


</body>

</html>